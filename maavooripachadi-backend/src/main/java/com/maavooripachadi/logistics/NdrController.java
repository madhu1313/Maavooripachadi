package com.maavooripachadi.logistics;
import org.springframework.web.bind.annotation.*; import lombok.RequiredArgsConstructor; import java.util.*; @RestController @RequestMapping("/api/v1/ndr") @RequiredArgsConstructor
public class NdrController { private final NdrService svc; @PostMapping("/issue/{orderNo}") public java.util.Map<String,String> issue(@PathVariable String orderNo){ return java.util.Map.of("url","https://maavooripachadi.com/ndr?token="+svc.issue(orderNo)); } @PostMapping("/action") public java.util.Map<String,Object> action(@RequestParam String token,@RequestBody java.util.Map<String,Object> body){ if(!svc.valid(token)) throw new org.springframework.web.server.ResponseStatusException(org.springframework.http.HttpStatus.GONE); svc.consume(token); return java.util.Map.of("ok",true); } }
